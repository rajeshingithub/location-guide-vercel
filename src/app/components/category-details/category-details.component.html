<div class="category-details-container" *ngIf="category">
    <!-- Header -->
    <header class="category-header">
        <div class="container">
            <button class="btn-back" (click)="goBack()">
                <span class="back-icon">‚Üê</span>
                <span>Back</span>
            </button>
            <div class="header-content fade-in">
                <div class="category-icon-large">{{ category.icon }}</div>
                <h1 class="category-title">{{ category.name }}</h1>
                <p class="category-subtitle">
                    {{ category.places.length }} Places found
                </p>
            </div>
        </div>
    </header>

    <!-- STATIC MAP SECTION -->
    <div class="static-map-container fade-in" *ngIf="mapPins.length > 0">
        <img [src]="staticMapUrl" alt="Category Map" class="map-image">

        <div *ngFor="let pin of mapPins" class="map-pin" [class.active]="activePinId === pin.id" [style.left.%]="pin.x"
            [style.top.%]="pin.y" (click)="togglePin(pin.id)">

            <div class="pin-icon"></div>

            <!-- CLICKABLE TOOLTIP -->
            <!-- The (click) event is here on the wrapper -->
            <div class="pin-tooltip clickable-tooltip" *ngIf="activePinId === pin.id"
                (click)="openGoogleMaps($event, pin.latitude, pin.longitude)">

                <img [src]="pin.image || 'assets/placeholder.jpg'" class="tooltip-img">
                <h4 class="tooltip-title">{{ pin.name }}</h4>
                <div class="tooltip-action">
                    <span>üìç Tap to Navigate</span>
                </div>
            </div>
        </div>
    </div>

    <!-- PLACES LIST (Controlled by Service via shouldShowList) -->
    <main class="main-content" *ngIf="shouldShowList">
        <div class="container">
            <div class="places-grid">
                <div *ngFor="let place of category.places; let i = index" class="place-card"
                    (click)="selectPlace(place)">
                    <!-- Grid content... -->
                    <div class="place-image-wrapper">
                        <img [src]="place.image" class="place-image">
                        <div class="place-badge"><span class="badge-icon">üìç</span></div>
                    </div>
                    <div class="place-content">
                        <h3 class="place-title">{{ place.name }}</h3>
                        <div class="place-footer">
                            <span class="place-address">{{ place.address.split(',')[0] }}</span>
                            <button class="btn-details">Details ‚Üí</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Modal Code remains same -->
<div class="modal-overlay" *ngIf="selectedPlace" (click)="closeDetails()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <!-- ... modal content ... -->
        <button class="btn-navigate" (click)="navigateToPlace(selectedPlace)">
            Google Maps
        </button>
    </div>
</div>